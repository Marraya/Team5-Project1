<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Firebase Happy Hour Database</title>
    <script src="https://www.gstatic.com/firebasejs/5.8.5/firebase.js"></script>
    <script>
    var config = {
    apiKey: "AIzaSyDc09T-OmJie6bBbWkx0FWsPT9Mk10ROp0",
    authDomain: "happy-hour-proje-1551302378847.firebaseapp.com",
    databaseURL: "https://happy-hour-proje-1551302378847.firebaseio.com",
    projectId: "happy-hour-proje-1551302378847",
    storageBucket: "happy-hour-proje-1551302378847.appspot.com",
    messagingSenderId: "650709499185"
    };
    firebase.initializeApp(config);
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>


</head>
<body>
    <!-- Value -->
    <!-- <table>
        <tr>
            <td>Id</td>
            <td><input type="text" name="id" id="user_id"/></td>
        </tr>

        <tr>
            <td>Bar Name:</td>
            <td><input type="text" name="bar_location" id="bar_name" required="required"/></td>
        </tr>
        <tr>
            <td>Bar Location:</td>
            <td><input type="string" name="bar_location" id="bar_location" required="required"/></td>
        </tr>
        <tr>
            <td>Closing Time:</td>
            <td><input type="time" name="closingTime" id="closingTime" required="required"/></td>
        </tr>
        <tr></tr><tr></tr>
        <tr> <td><strong>Menu</strong></td></tr>
        <tr> <td><strong>Drinks Price</strong></td></tr>
        <tr>  
            <td>Beers:</td>
            <td><input type="number" name="drinks_beer" id="drinks_beer" required="required"/></td>
        </tr>
        <tr>
            <td>Wine:</td>
            <td><input type="number" name="drinks_wine" id="drinks_wine" required="required"/></td>
        </tr>
        <tr>
            <td>Mix Drinks:</td>
            <td><input type="number" name="drinks_mix" id="drinks_mix" required="required"/></td>
        </tr>
        <tr></tr>
        <tr> <td><strong>Food Price</strong></td></tr>
        <tr>
            <td>Wings:</td>
            <td><input type="number" name="food_wings" id="food_wings" required="required"/></td>
        </tr>

        <td colspan="2">
            <input type="button" value="Save" onclick="save_user();"/>
            <input type="button" value="Update" onclick="update_user();"/>
            <input type="button" value="Delete" onclick="delete_user();"/>
        </td>
    </table> -->
    <!-- <button onclick="snapshot()">Restaurant Information</button> -->
    <h3>Restaurant Information</h3>
    <table id="tbl_restaurant_info" border="1">
        <tr>
            
            <td>Bar Name</td>
            <td>Bar Location</td>
            <td>Closing Time</td>
            <td>Beers</td>
            <td>Wines</td>
            <td>Mix Drinks</td>
            <td>Wings</td>
        </tr>
    </table>
    <p id="container"></p>
    <p id="container1"></p>
<h1>My Google Map</h1>

  <div id="map"></div>

  <script>

    function initMap(){

      // Map options

      var options = {

        zoom:13,

        center:{lat:40.7549,lng:-73.9840}

      }



      // New map

      var map = new google.maps.Map(document.getElementById('map'), options);



      // Listen for click on map

      google.maps.event.addListener(map, 'click', function(event){

        // Add marker

        addMarker({coords:event.latLng});

      });



      /*

      // Add marker

      var marker = new google.maps.Marker({

        position:{lat:42.4668,lng:-70.9495},

        map:map,

        icon:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'

      });



      var infoWindow = new google.maps.InfoWindow({

        content:'<h1>Lynn MA</h1>'

      });



      marker.addListener('click', function(){

        infoWindow.open(map, marker);

      });

      */



      // Array of markers

      var markers = [

        {

          coords:{lat:40.7527,lng:-73.9772},

          iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',

          content:'<h3>Bar 1</h3><p>Menu:<br>Drink<br>Food</p>'

        },

        {

          coords:{lat:40.7484,lng:-73.9857},
          iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
          content:'<h1>Menu:</h1>'

        },

        {

          coords:{lat:42.7762,lng:-71.0773}

        }

      ];



      // Loop through markers

      for(var i = 0;i < markers.length;i++){

        // Add marker

        addMarker(markers[i]);

      }



      // Add Marker Function

      function addMarker(props){

        var marker = new google.maps.Marker({

          position:props.coords,

          map:map,

          //icon:props.iconImage

        });



        // Check for customicon

        if(props.iconImage){

          // Set icon image

          marker.setIcon(props.iconImage);

        }



        // Check content

        if(props.content){

          var infoWindow = new google.maps.InfoWindow({

            content:props.content

          });



          marker.addListener('click', function(){

            infoWindow.open(map, marker);

          });

        }

      }

    }

  
// <script src="database.js"></script> 
<script>
    // localStorage.setItem('logged-user_id', "-L_AF--wreUG4JwFyHBZ");
        // var tblrestaurant = document.getElementById('tbl_restaurant_info');
        var databaseRef = firebase.database().ref('/restaurants/');
        var rowIndex = 1;
        // listening for event value change
        databaseRef.once('value', function(snapshot) {
         snapshot.forEach(function(childSnapshot) {
            var childKey = childSnapshot.key;
            var childData = childSnapshot.val();
            if (childData.user_id === "-L_AF--wreUG4JwFyHBZ") {
                console.log('only show this restauarnt');
                console.log(childData)

             $("#container").append(childData.bar_name + " " + childData.bar_location + " " + childData.closingTime + " Beer Price:" + childData.drinks_beer + " Wine Price:" + childData.drinks_wine + " Mix Drink Price:" + childData.drinks_mix + " Wings Price:" +childData.food_wings);
            
            }  
            if (childData.user_id === "-L_AFAPfSdyGTDHxxhEC") {
                console.log('only show this restauarnt');
                console.log(childData)

             $("#container1").append(childData.bar_name + " " + childData.bar_location + " " + childData.closingTime + " Beer Price:" + childData.drinks_beer + " Wine Price:" + childData.drinks_wine + " Mix Drink Price:" + childData.drinks_mix + " Wings Price:" +childData.food_wings);
            
            }  
            });
        });

        
    // function save_user(){
    //     // var user_id = document.getElementById('user_id').value;
    //     var bar_name = document.getElementById('bar_name').value;
    //     var bar_location = document.getElementById('bar_location').value;
    //     var closingTime = document.getElementById('closingTime').value;
    //     var drinks_beer = document.getElementById('drinks_beer').value;
    //     var drinks_wine = document.getElementById('drinks_wine').value;
    //     var drinks_mix = document.getElementById('drinks_mix').value;
    //     var food_wings = document.getElementById('food_wings').value;
    //     var uid = firebase.database().ref().child('/restaurants/').push().key;

    //     var data = {
    //         user_id: uid,
    //         bar_name: bar_name,
    //         bar_location: bar_location,
    //         closingTime: closingTime,
    //         drinks_beer: drinks_beer,
    //         drinks_wine: drinks_wine,
    //         drinks_mix: drinks_mix,
    //         food_wings: food_wings
    //     }

    //     var updates = {};
    //     updates['/restaurants/' + uid] = data;
    //     firebase.database().ref().update(updates);

    //     alert('The Restaurant info has been created successfully');
    //     reload_page();
        
    // }
    // // 24.20 seconds
    // function update_user(){
    //     var user_id = document.getElementById('user_id').value;
    //     var bar_name = document.getElementById('bar_name').value;
    //     var bar_location = document.getElementById('bar_location').value;
    //     var closingTime = document.getElementById('closingTime').value;
    //     var drinks_beer = document.getElementById('drinks_beer').value;
    //     var drinks_wine = document.getElementById('drinks_wine').value;
    //     var drinks_mix = document.getElementById('drinks_mix').value;
    //     var food_wings = document.getElementById('food_wings').value;     
    //     // alert('user_id');

    //     var data = {
    //         user_id: user_id,
    //         bar_name: bar_name,
    //         bar_location: bar_location,
    //         closingTime: closingTime,
    //         drinks_beer: drinks_beer,
    //         drinks_wine: drinks_wine,
    //         drinks_mix: drinks_mix,
    //         food_wings: food_wings
    //     }
    //     // var updates = {};
    //     // updates['/restaurants/' + user_id] = data;
    //     firebase.database().ref().child('/restaurants/' + user_id).update(data);

    //     alert('Updated successfully');

    //     reload_page();
    // }
    // function delete_user(){
    //     var user_id = document.getElementById('user_id').value;
    //     var bar_name = document.getElementById('bar_name').value;
    //     var bar_location = document.getElementById('bar_location').value;
    //     var closingTime = document.getElementById('closingTime').value;
    //     var drinks_beer = document.getElementById('drinks_beer').value;
    //     var drinks_wine = document.getElementById('drinks_wine').value;
    //     var drinks_mix = document.getElementById('drinks_mix').value;
    //     var food_wings = document.getElementById('food_wings').value;
    //     firebase.database().ref().child('/restaurants/' + user_id).remove();
    //     alert('The Restaurant Info has been deleted successfully');
    //     reload_page();
        
    // }
    // function reload_page(){

    // }

  

function initMap(){

  // Map options

  var options = {

    zoom:13,

    center:{lat:40.7549,lng:-73.9840}

  }



  // New map

  var map = new google.maps.Map(document.getElementById('map'), options);



  // Listen for click on map

  google.maps.event.addListener(map, 'click', function(event){

    // Add marker

    addMarker({coords:event.latLng});

  });



  /*

  // Add marker

  var marker = new google.maps.Marker({

    position:{lat:42.4668,lng:-70.9495},

    map:map,

    icon:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'

  });



  var infoWindow = new google.maps.InfoWindow({

    content:'<h1>Lynn MA</h1>'

  });



  marker.addListener('click', function(){

    infoWindow.open(map, marker);

  });

  */



  // Array of markers

  var markers = [

    {

      coords:{lat:40.7527,lng:-73.9772},

      iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',

      content:'<h3>Bar 1</h3><p>Menu:<br>Drink<br>Food</p>'

    },

    {

      coords:{lat:40.7484,lng:-73.9857},
      iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
      content:'<h1>Menu:</h1>'

    },

    {

      coords:{lat:42.7762,lng:-71.0773}

    }

  ];



  // Loop through markers

  for(var i = 0;i < markers.length;i++){

    // Add marker

    addMarker(markers[i]);

  }



  // Add Marker Function

  function addMarker(props){

    var marker = new google.maps.Marker({

      position:props.coords,

      map:map,

      //icon:props.iconImage

    });



    // Check for customicon

    if(props.iconImage){

      // Set icon image

      marker.setIcon(props.iconImage);

    }



    // Check content

    if(props.content){

      var infoWindow = new google.maps.InfoWindow({

        content:props.content

      });



      marker.addListener('click', function(){

        infoWindow.open(map, marker);

      });

    }

  }

}

</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAzsfXudxbOJc1VXWKlJfSQelZB_Ywffyk&callback=initMap">

</script>
</body>
</html>